(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{370:function(t,e,r){var content=r(374);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(35).default)("0a2549cb",content,!0,{sourceMap:!1})},371:function(t,e,r){var content=r(376);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(35).default)("0273269d",content,!0,{sourceMap:!1})},373:function(t,e,r){"use strict";var o=r(370);r.n(o).a},374:function(t,e,r){(e=r(34)(!1)).push([t.i,".form[data-v-494839ac]{padding:25px}.form-item[data-v-494839ac]{margin-bottom:20px}.form-text[data-v-494839ac]{font-size:12px;color:#409eff;text-align:right;line-height:1}.submit[data-v-494839ac]{width:100%;margin-top:10px}",""]),t.exports=e},375:function(t,e,r){"use strict";var o=r(371);r.n(o).a},376:function(t,e,r){(e=r(34)(!1)).push([t.i,".form[data-v-435c5fab]{padding:25px}.form-item[data-v-435c5fab]{margin-bottom:20px}.form-text[data-v-435c5fab]{font-size:12px;color:#409eff;text-align:right;line-height:1}.submit[data-v-435c5fab]{width:100%;margin-top:10px}",""]),t.exports=e},377:function(t,e,r){"use strict";r.r(e);function o(source,t){if(null==source)return{};var e,i,r=function(source,t){if(null==source)return{};var e,i,r={},o=Object.keys(source);for(i=0;i<o.length;i++)e=o[i],t.indexOf(e)>=0||(r[e]=source[e]);return r}(source,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(source);for(i=0;i<o.length;i++)e=o[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(r[e]=source[e])}return r}var n={data:function(){var t=this;return{form:{username:"",nickname:"",captcha:"",password:"",checkPassword:""},rules:{username:[{required:!0,message:"该项不能为空",trigger:"blur"},{min:5,max:11,message:"请输入合法手机号",trigger:"blur"}],nickname:[{required:!0,message:"该项不能为空",trigger:"blur"}],captcha:[{required:!0,message:"该项不能为空",trigger:"blur"}],password:[{required:!0,message:"该项不能为空",trigger:"blur"}],checkPassword:[{validator:function(e,r,o){""==r?o(new Error("请再次输入密码")):r!=t.form.password?o(new Error("两次密码必须一致")):o()},trigger:"blur"}]}}},methods:{handleRegSubmit:function(){var t=this;console.log(this.form),this.$refs.form.validate().then((function(e){console.log("校验成功");var r=t.form,data=(r.checkPassword,o(r,["checkPassword"]));t.$axios({method:"post",url:"/accounts/register",data:data}).then((function(e){console.log(e.data),t.$message.success("注册成功"),t.$store.commit("user/setUserInfo",e.data)})).catch((function(t){console.dir(t)}))})).catch((function(t){console.log("校验失败")}))},handleSendCaptcha:function(){var t=this;this.$axios({method:"post",url:"/captchas",data:{tel:this.form.username}}).then((function(e){console.log(e.data),e.data.code&&t.$message.success("验证码发送成功: "+e.data.code)}))}}},c=(r(375),r(19)),component=Object(c.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,rules:t.rules}},[r("el-form-item",{staticClass:"form-item",attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:"用户名手机"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),t._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"captcha"}},[r("el-input",{attrs:{placeholder:"验证码"},model:{value:t.form.captcha,callback:function(e){t.$set(t.form,"captcha",e)},expression:"form.captcha"}},[r("template",{slot:"append"},[r("el-button",{on:{click:t.handleSendCaptcha}},[t._v("\n                    发送验证码\n                ")])],1)],2)],1),t._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"nickname"}},[r("el-input",{attrs:{placeholder:"你的名字"},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),t._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"password"}},[r("el-input",{attrs:{placeholder:"密码",type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"checkPassword"}},[r("el-input",{attrs:{placeholder:"确认密码",type:"password"},model:{value:t.form.checkPassword,callback:function(e){t.$set(t.form,"checkPassword",e)},expression:"form.checkPassword"}})],1),t._v(" "),r("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:t.handleRegSubmit}},[t._v("\n        注册\n    ")])],1)}),[],!1,null,"435c5fab",null);e.default=component.exports},378:function(t,e,r){"use strict";r.r(e);var o={data:function(){return{form:{username:"13800138000",password:"123456"},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入11位合法手机号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码必须6位以上",trigger:"blur"}]}}},methods:{handleLoginSubmit:function(){var t=this;this.$refs.form.validate().then((function(e){console.log(e),console.log("校验成功"),e&&t.$store.dispatch("user/login",t.form).then((function(e){t.$message.success("登录成功"),t.$router.back(),t.$emit("logins"),console.log(e)}))})).catch((function(t){console.log(t),console.log("校验失败")})),console.log(this.form)},hideErrMsg:function(t){this.$refs.form.clearValidate(t)}}},n=(r(373),r(19)),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,rules:t.rules}},[r("el-form-item",{staticClass:"form-item",attrs:{prop:"username"}},[r("el-input",{attrs:{placeholder:"用户名/手机"},on:{focus:function(e){return t.hideErrMsg("username")}},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),t._v(" "),r("el-form-item",{staticClass:"form-item",attrs:{prop:"password"}},[r("el-input",{attrs:{placeholder:"密码",type:"password"},on:{focus:function(e){return t.hideErrMsg("password")}},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),r("p",{staticClass:"form-text"},[r("nuxt-link",{attrs:{to:"#"}},[t._v("忘记密码")])],1),t._v(" "),r("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:t.handleLoginSubmit}},[t._v("\n    登录\n  ")])],1)}),[],!1,null,"494839ac",null);e.default=component.exports},538:function(t,e,r){var content=r(601);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(35).default)("0d2b6aa6",content,!0,{sourceMap:!1})},539:function(t,e,r){var content=r(603);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(35).default)("3d9f7176",content,!0,{sourceMap:!1})},540:function(t,e,r){var content=r(605);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(35).default)("d2bd4160",content,!0,{sourceMap:!1})},600:function(t,e,r){"use strict";var o=r(538);r.n(o).a},601:function(t,e,r){(e=r(34)(!1)).push([t.i,".container[data-v-4ec5912c]{width:1000px;margin:20px auto}.aside[data-v-4ec5912c]{width:350px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;border:1px solid #ddd}",""]),t.exports=e},602:function(t,e,r){"use strict";var o=r(539);r.n(o).a},603:function(t,e,r){(e=r(34)(!1)).push([t.i,".air-column[data-v-2e19f83f]{border-bottom:1px dashed #ddd;padding-bottom:20px;margin-bottom:20px}.air-column h2[data-v-2e19f83f]{margin-bottom:20px;font-size:22px;font-weight:400}[data-v-2e19f83f] .el-select .el-input{width:130px}.input-with-select[data-v-2e19f83f]{width:590px}.input-with-select[data-v-2e19f83f] .el-input-group__prepend{background-color:#fff}.member-info-item[data-v-2e19f83f]{border-bottom:1px dashed #eee;padding-bottom:20px;position:relative}.member-info-item:first-child .delete-user[data-v-2e19f83f]{display:none}.add-member[data-v-2e19f83f]{margin-top:20px}.delete-user[data-v-2e19f83f]{display:block;background:#ddd;width:16px;height:16px;font-size:14px;text-align:center;line-height:16px;color:#fff;cursor:pointer;border-radius:50px;position:absolute;right:-30px;top:50%}.insurance>div[data-v-2e19f83f]{margin-top:10px}.insurance-item[data-v-2e19f83f]{margin-bottom:20px}.contact[data-v-2e19f83f] .el-input{width:50%}.submit[data-v-2e19f83f]{margin:50px auto;display:block;width:250px;height:50px}.container .main[data-v-2e19f83f]{height:100%;margin:0 auto;position:relative}.container .main .form-wrapper[data-v-2e19f83f]{width:400px;margin:0 auto;background:#fff;box-shadow:2px 2px 0 rgba(0,0,0,.1);overflow:hidden}.container .main .form-wrapper[data-v-2e19f83f] .el-input{width:100%!important}.container .main .form-wrapper .tabs span[data-v-2e19f83f]{display:block;width:50%;height:50px;box-sizing:border-box;border-top:2px solid #eee;background:#eee;line-height:48px;text-align:center;cursor:pointer;color:#666}.container .main .form-wrapper .tabs span.active[data-v-2e19f83f]{color:orange;border-top-color:orange;background:#fff;font-weight:700}",""]),t.exports=e},604:function(t,e,r){"use strict";var o=r(540);r.n(o).a},605:function(t,e,r){(e=r(34)(!1)).push([t.i,".aside[data-v-6f7cf82c]{width:350px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;border:1px solid #ddd}.air-info[data-v-6f7cf82c]{padding:15px}.air-info .info-top[data-v-6f7cf82c]{margin-bottom:10px}.air-info .info-top>div[data-v-6f7cf82c]:last-child{font-size:14px}.air-info .info-step .flight-airport strong[data-v-6f7cf82c]{display:block;font-size:22px;font-weight:400}.air-info .info-step .flight-airport span[data-v-6f7cf82c]{font-size:12px;color:#999}.air-info .info-step .flight-time[data-v-6f7cf82c]{text-align:center;font-size:12px;color:#999}.air-info .info-step .flight-time span[data-v-6f7cf82c]{display:block}.info-bar[data-v-6f7cf82c]{border-top:1px dashed #ddd;padding:10px 15px;font-size:14px;color:#666}.info-bar .price[data-v-6f7cf82c]{font-size:28px;color:orange}",""]),t.exports=e},675:function(t,e,r){"use strict";r.r(e);r(28),r(233),r(17),r(45),r(29),r(46);var o=r(74),n=(r(64),r(6)),c={props:{data:Object},data:function(){return{currentTab:0,contactRules:{contactName:[{required:!0,message:"请输入数据",trigger:"blur"}],contactPhone:[{required:!0,message:"请输入数据",trigger:"blur"}],captcha:[{required:!0,message:"请输入数据",trigger:"blur"}]},users:[{username:"哈哈",id:"450433222222222222",uid:(new Date).getTime()}],insurances:[],contactName:"呵呵",contactPhone:"13847474837",captcha:"000000",invoice:!1}},computed:{totalPrice:function(){var t=this,e=this.data.base_price*this.users.length,r=0;this.insurances.forEach((function(e){r+=t.getInsurancePrice(e)})),console.log(r);var o=e+r;return this.$emit("setTotalPrice",o),console.log("计算总价"+o),o}},methods:{handleChangeTab:function(t){this.currentTab=t},getInsurancePrice:function(t){var e=this,r=0;return this.data.insurances.forEach((function(element){t==element.id&&(r=element.price*e.users.length)})),r},handleSubmit:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("点击按钮提交"),e.next=3,Promise.all([t.$refs.usersForm.validate(),t.$refs.contactForm.validate()]);case 3:r=e.sent,n=Object(o.a)(r,2),c=n[0],l=n[1],c&&l&&t.sendRequest();case 8:case"end":return e.stop()}}),e)})))()},sendRequest:function(){var t=this;console.log(this.users),console.log(this.insurances);var data={users:this.users,insurances:this.insurances,contactName:this.contactName,contactPhone:this.contactPhone,invoice:this.invoice,seat_xid:this.$route.query.seat_xid,air:this.$route.query.id,captcha:this.captcha};this.$axios({method:"post",url:"/airorders",headers:{Authorization:"Bearer "+this.$store.state.user.userInfo.token},data:data}).then((function(e){console.log(e.data),(e.data.message="订单提交成功")&&t.$router.push("/air/pay?id="+e.data.data.id)}))},handleSendCaptcha:function(){var t=this;if(this.contactPhone){/^1[3456789]\d{9}$/.test(this.contactPhone)?this.$axios({method:"post",url:"/captchas",data:{tel:this.contactPhone}}).then((function(e){console.log(e.data),e.data.code&&t.$message.success("发送成功："+e.data.code)})):this.$message.error("手机号不合法")}else this.$message.error("请先输入手机号")},handleAddUsers:function(){this.users.push({username:"",id:"",uid:(new Date).getTime()})},handleDeleteUser:function(t){this.users.splice(t,1)}}},l=(r(602),r(19)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main"},[r("div",{staticClass:"air-column"},[r("h2",[t._v("乘机人")]),t._v(" "),r("el-form",{ref:"usersForm",staticClass:"member-info",attrs:{model:{users:t.users}}},t._l(t.users,(function(e,o){return r("div",{key:e.uid,staticClass:"member-info-item"},[r("el-form-item",{attrs:{label:"乘机人姓名",prop:"users["+o+"].username",rules:[{required:!0,message:"请输入数据",trigger:"blur"}]}},[r("el-input",{staticClass:"input-with-select",attrs:{placeholder:"姓名"},model:{value:e.username,callback:function(r){t.$set(e,"username",r)},expression:"user.username"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"身份证号码",prop:"users["+o+"].id",rules:[{required:!0,message:"请输入数据",trigger:"blur"}]}},[r("el-input",{staticClass:"input-with-select",attrs:{placeholder:"证件号码"},model:{value:e.id,callback:function(r){t.$set(e,"id",r)},expression:"user.id"}})],1),t._v(" "),r("span",{staticClass:"delete-user",on:{click:function(e){return t.handleDeleteUser(o)}}},[t._v("-")])],1)})),0),t._v(" "),r("el-button",{staticClass:"add-member",attrs:{type:"primary"},on:{click:t.handleAddUsers}},[t._v("添加乘机人")])],1),t._v(" "),r("div",{staticClass:"air-column"},[r("h2",[t._v("保险")]),t._v(" "),r("div",[r("el-checkbox-group",{model:{value:t.insurances,callback:function(e){t.insurances=e},expression:"insurances"}},t._l(t.data.insurances,(function(e){return r("div",{key:e.id,staticClass:"insurance-item"},[r("el-checkbox",{attrs:{label:e.id,border:""}},[t._v("\n                        "+t._s(e.type+": ￥"+e.price+"/份 x "+t.users.length+" 最高赔付 "+e.compensation)+"\n                    ")])],1)})),0)],1),t._v(" "),r("h2",[t._v("发票")]),t._v(" "),r("div",[r("el-checkbox",{model:{value:t.invoice,callback:function(e){t.invoice=e},expression:"invoice"}},[t._v("需要发票")])],1)]),t._v(" "),r("div",{staticClass:"air-column"},[r("h2",[t._v("联系人")]),t._v(" "),r("div",{staticClass:"contact"},[r("el-form",{ref:"contactForm",attrs:{"label-width":"80px",model:{contactName:t.contactName,contactPhone:t.contactPhone,captcha:t.captcha},rules:t.contactRules}},[r("el-form-item",{attrs:{label:"姓名",prop:"contactName"}},[r("el-input",{model:{value:t.contactName,callback:function(e){t.contactName=e},expression:"contactName"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"手机",prop:"contactPhone"}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.contactPhone,callback:function(e){t.contactPhone=e},expression:"contactPhone"}},[r("template",{slot:"append"},[r("el-button",{on:{click:t.handleSendCaptcha}},[t._v("发送验证码")])],1)],2)],1),t._v(" "),r("el-form-item",{attrs:{label:"验证码",prop:"captcha"}},[r("el-input",{model:{value:t.captcha,callback:function(e){t.captcha=e},expression:"captcha"}})],1)],1),t._v(" "),t.$store.state.user.userInfo.token?r("el-button",{staticClass:"submit",attrs:{type:"warning"},on:{click:t.handleSubmit}},[t._v("\n                提交订单\n            ")]):r("div",{staticClass:"container"},[r("el-row",{staticClass:"main",attrs:{type:"flex",justify:"center",align:"middle"}},[r("div",{staticClass:"form-wrapper"},[r("el-row",{staticClass:"tabs",attrs:{type:"flex",justify:"center"}},t._l(["登录","注册"],(function(e,o){return r("span",{key:o,class:{active:t.currentTab===o},on:{click:function(e){return t.handleChangeTab(o)}}},[t._v("\n                                "+t._s(e)+"\n                            ")])})),0),t._v(" "),0==t.currentTab?r("LoginForm"):t._e(),t._v(" "),1==t.currentTab?r("RegisterForm"):t._e()],1)])],1)],1)]),t._v(" "),r("div",{staticStyle:{display:"none"}},[t._v("\n        "+t._s(t.totalPrice)+"\n    ")])])}),[],!1,null,"2e19f83f",null);e.default=component.exports;installComponents(component,{LoginForm:r(378).default,RegisterForm:r(377).default})},676:function(t,e,r){"use strict";r.r(e);r(163),r(62),r(164);var o={props:["data","totalPrice"],computed:{rankTime:function(){if(!this.data.dep_time)return"";var t=this.data.dep_time.split(":"),e=this.data.arr_time.split(":"),r=60*t[0]+ +t[1],o=60*e[0]+ +e[1],n=o-r;return n<0&&(n=o+1440-r),"".concat(Math.floor(n/60),"时").concat(n%60,"分")}}},n=(r(604),r(19)),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"aside"},[r("div",{staticClass:"air-info"},[r("el-row",{staticClass:"info-top",attrs:{type:"flex",justify:"space-between"}},[r("div",[t._v(t._s(t.data.dep_date))]),t._v(" "),r("div",[t._v(t._s(t.data.org_city_name)+" - "+t._s(t.data.dst_city_name))])]),t._v(" "),r("el-row",{staticClass:"info-step",attrs:{type:"flex",justify:"space-between",align:"middle"}},[r("el-col",{staticClass:"flight-airport",attrs:{span:5}},[r("strong",[t._v(t._s(t.data.dep_time))]),t._v(" "),r("span",[t._v(t._s(t.data.org_airport_name)+t._s(t.data.org_airport_quay))])]),t._v(" "),r("el-col",{staticClass:"flight-time",attrs:{span:14}},[r("span",[t._v("--- "+t._s(t.rankTime)+" ---")]),t._v(" "),r("span",[t._v(t._s(t.data.airline_name)+t._s(t.data.flight_no))])]),t._v(" "),r("el-col",{staticClass:"flight-airport",attrs:{span:5}},[r("strong",[t._v(t._s(t.data.arr_time))]),t._v(" "),r("span",[t._v("浦东机场T2")])])],1)],1),t._v(" "),r("el-row",{staticClass:"info-bar",attrs:{type:"flex",justify:"space-between"}},[r("span",[t._v("订单总价")]),t._v(" "),r("span",[t._v("金额")]),t._v(" "),r("span",[t._v("数量")])]),t._v(" "),r("el-row",{staticClass:"info-bar",attrs:{type:"flex",justify:"space-between"}},[r("span",[t._v("成人机票")]),t._v(" "),r("span",[t._v("￥"+t._s(t.data.seat_infos.org_settle_price))]),t._v(" "),r("span",[t._v("x1")])]),t._v(" "),r("el-row",{staticClass:"info-bar",attrs:{type:"flex",justify:"space-between"}},[r("span",[t._v("机建＋燃油")]),t._v(" "),r("span",[t._v("¥"+t._s(t.data.airport_tax_audlet)+"/人/单程")]),t._v(" "),r("span",[t._v("x1")])]),t._v(" "),r("el-row",{staticClass:"info-bar",attrs:{type:"flex",justify:"space-between",align:"middle"}},[r("span",[t._v("应付总额：")]),t._v(" "),r("span",{staticClass:"price"},[t._v("￥ "+t._s(t.totalPrice))])])],1)}),[],!1,null,"6f7cf82c",null);e.default=component.exports},692:function(t,e,r){"use strict";r.r(e);var o={data:function(){return{flightData:{},totalPrice:0}},created:function(){var t=this;this.$axios({url:"/airs/"+this.$route.query.id,params:{seat_xid:this.$route.query.seat_xid}}).then((function(e){console.log(e.data),t.flightData=e.data}))},methods:{setTotalPrice:function(t){this.totalPrice=t}}},n=(r(600),r(19)),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("el-row",{attrs:{type:"flex",justify:"space-between"}},[r("div",{staticClass:"main"},[t.flightData.id?r("OrderForm",{attrs:{data:t.flightData},on:{setTotalPrice:t.setTotalPrice}}):t._e()],1),t._v(" "),r("div",{staticClass:"aside"},[t.flightData.id?r("OrderAside",{attrs:{data:t.flightData,totalPrice:t.totalPrice}}):t._e()],1)])],1)}),[],!1,null,"4ec5912c",null);e.default=component.exports;installComponents(component,{OrderForm:r(675).default,OrderAside:r(676).default})}}]);